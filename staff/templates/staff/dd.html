{% extends 'base.html' %} {% load static %} {% block title %}
  Staff
{% endblock %} {% block extra_head %}
  <!-- CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

  <link rel="stylesheet" href="{% static 'personnel.css' %}" />
{% endblock %} {% block sidebar %}
  {% include './includes/personnel-sidebar.html' with active_page='dashboard' %}
{% endblock %} {% block content %}
  <div class="main">
    <h2 style="margin-left: 30px; margin-top: 20px">Front Office</h2>
    <div class="row">
      <div class="div1 vacant">R1</div>
      <div class="div2 vacant">R2</div>
      <div class="div3">
        <span>View Logs</span>
        <input class="form-control" type="date" />
      </div>
      <div class="div6 maintinance">R6</div>
      <div class="div7 occupied">R7</div>
      <div class="div8 vacant">R3</div>
      <div class="div9 occupied">R4</div>
      <div class="div10 occupied">R5</div>
      <div class="div11 vacant">R8</div>
      <div class="div12 vacant">R9</div>
      <div class="div13 occupied">R10</div>
      <div class="div14 maintinance">R11</div>
      <div class="div15 vacant">R12</div>
    </div>
    <div class="row2">
      <div class="walk-in">
        <button class="btn" id="walkinBTN">Walk-in</button>
      </div>
      <div class="check-in">
        <button class="btn" id="check-in-modal">Check-in</button>
      </div>
      <div class="check-out">
        <a href="" class="btn">Check-out</a>
      </div>
      <div class="view-reservations">
        <a href="" class="btn">View Reservations</a>
      </div>
    </div>

    <div class="row3">
      <div class="room-information">
        <div class="room-info-label">Room Information :</div>
        <div class="cont">
          <div class="col1">
            <div class="RI-vacant">
              <div class="vacant-box vacant">3</div>
              <span>Vacant</span>
            </div>
            <div class="RI-occupied">
              <div class="occupied-box occupied">3</div>
              <span>Occupied</span>
            </div>
          </div>
          <div class="col2">
            <div class="RI-under_maintinance">
              <div class="under_maintinance-box maintinance">2</div>
              <span>Under Maintenance</span>
            </div>
            <div class="RI-housekeeping">
              <div class="housekeeping-box housekeeping">2</div>
              <span>Housekeeping</span>
            </div>
          </div>
          <div class="col3">
            <div class="RI-reserved">
              <div class="reserved-box reserved">0</div>
              <span>Reserved</span>
            </div>
            <div class="total">
              <span>Total: 100</span>
            </div>
          </div>
        </div>
      </div>
      <div class="rooms-occupied">
        <span style="text-decoration: none !important">Rooms Occupied :</span>
        <div class="ro-deluxe mt-3">
          <span>Deluxe</span>
          <div class="ro-count" style="text-decoration: underline">3</div>
        </div>
        <div class="ro-family">
          <span>Family</span>
          <div class="ro-count" style="text-decoration: underline">2</div>
        </div>
        <div class="ro-standard">
          <span>Standard</span>
          <div class="ro-count" style="text-decoration: underline">1</div>
        </div>
      </div>
    </div>
  </div>
  {% include './includes/walk-in-modal.html' %} {% include './includes/check-in-modal.html' %}
{% endblock %} {% block extra_js %}
  <script>
    flatpickr('#calendar', {
      dateFormat: 'Y-m-d',
      disableMobile: true, // Forces desktop-style calendar on mobile
      monthSelectorType: 'static' // Ensure month/year are always visible
    })
    flatpickr('#check-in', {
      dateFormat: 'Y-m-d',
      disableMobile: true,
      monthSelectorType: 'static' // Ensure month/year are always visible
    })
    flatpickr('#check-out', {
      dateFormat: 'Y-m-d',
      disableMobile: true,
      monthSelectorType: 'static' // Ensure month/year are always visible
    })
  </script>
  <script>
    function updateCardFields() {
      const paymentMethod = document.getElementById('payment-method')
      const cardFields = document.querySelectorAll('.card-fields')
      if (paymentMethod.value === 'credit-card') {
        cardFields.forEach((field) => {
          field.hidden = false // Show the field
        })
      } else {
        cardFields.forEach((field) => {
          field.hidden = true // Hide the field
        })
      }
    }
    
    var modal = document.getElementById('walkin')
    var check_inModal = document.getElementById('checkin')
    // Get the button that opens the modal
    var btn = document.getElementById('walkinBTN')
    var check_inBtn = document.getElementById('check-in-modal')
    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName('close')[0]
    // When the user clicks on the button, open the modal
    btn.onclick = function () {
      modal.style.display = 'block'
      startWalkInTimer() // Start the timer when the modal opens
      updateCardFields()
    }
    check_inBtn.onclick = function (event) {
      event.preventDefault() // Prevent default link behavior
      check_inModal.style.display = 'block'
      startCheckInTimer()
      updateCardFields()
    }
    // When the user clicks on <span> (x), close the modal
    span.onclick = function () {
      modal.style.display = 'none'
    }
    // When the user clicks anywhere outside of the modal content, close it
    window.onclick = function (event) {
      if (event.target === modal) {
        modal.style.display = 'none'
      } else if (event.target === check_inModal) {
        check_inModal.style.display = 'none'
      }
    }
    // Handle payment method selection
    document.addEventListener('DOMContentLoaded', function () {
      const paymentMethod = document.getElementById('payment-method')
      updateCardFields()
      paymentMethod.addEventListener('change', updateCardFields)
    })
    
    function startWalkInTimer() {
      let duration = 5 * 60 // 5 minutes in seconds
      const timerDisplay = document.getElementById('walkin-timer')
    
      const countdown = setInterval(() => {
        const minutes = Math.floor(duration / 60)
        const seconds = duration % 60
    
        timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`
    
        if (--duration < 0) {
          clearInterval(countdown)
          timerDisplay.textContent = "Time's up!"
        }
      }, 1000)
    }
    
    function startCheckInTimer() {
      let duration = 5 * 60 // 5 minutes in seconds
      const timerDisplay = document.getElementById('checkin-timer')
    
      const countdown = setInterval(() => {
        const minutes = Math.floor(duration / 60)
        const seconds = duration % 60
    
        timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`
    
        if (--duration < 0) {
          clearInterval(countdown)
          timerDisplay.textContent = "Time's up!"
        }
      }, 1000)
    }
  </script>
{% endblock %}
