{% extends 'base.html' %}
{% load static %}

{% block title %}
  Book Reservation
{% endblock %}

{% block extra_head %}
  <style>
    .main-content {
      background: #fff;
      border: 1px solid #8b5cf6;
      border-radius: 8px;
      padding: 20px;
      margin: 15px;
    }
    
    .page-title {
      color: #1a2d1a;
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 20px;
    }
    
    .section-title {
      color: #1a2d1a;
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 15px;
    }
    
    .required-field {
      color: #dc3545;
      font-size: 0.8rem;
      margin-bottom: 15px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-label {
      color: #1a2d1a;
      font-weight: 500;
      margin-bottom: 5px;
      display: block;
      font-size: 0.9rem;
    }
    
    .form-control {
      border: 1px solid #cddcc9;
      border-radius: 6px;
      padding: 8px;
      font-size: 0.9rem;
      width: 100%;
    }
    
    .form-control:focus {
      border-color: #7eb455;
      box-shadow: 0 0 0 0.2rem rgba(126, 180, 85, 0.25);
      outline: none;
    }
    
    .payment-section {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
    }
    
    .payment-option {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .payment-option input[type='radio'] {
      margin-right: 10px;
      transform: scale(1.2);
    }
    
    .payment-option label {
      color: #1a2d1a;
      font-weight: 500;
      margin: 0;
      font-size: 0.9rem;
    }
    
    .payment-icons {
      display: flex;
      gap: 8px;
      margin-left: 15px;
    }
    
    .payment-icon {
      width: 35px;
      height: 22px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.7rem;
      font-weight: bold;
    }
    
    .payment-icon.visa {
      background: #1a1f71;
    }
    
    .payment-icon.mastercard {
      background: #000;
    }
    
    .payment-icon.amex {
      background: #006fcf;
    }
    
    .payment-note {
      color: #6c757d;
      font-size: 0.8rem;
      margin-top: 10px;
    }
    
    .next-btn {
      background: #1a2d1a;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 10px 25px;
      font-size: 0.9rem;
      font-weight: 600;
      margin-top: 15px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    
    .next-btn:hover {
      background: #0b440c;
    }
  </style>
{% endblock %}

{% block sidebar %}
  {% include './includes/sidebar.html' with active_page='book_reservation' %}
{% endblock %}

{% block content %}
  <div class="main-content">
    <h1 class="page-title">Book Reservation</h1>

    <div class="row">
      <!-- Lead Guest Information Section -->
      <div class="col-md-6">
        <h2 class="section-title">Lead Guest Information</h2>
        <div class="required-field">*This is a required field.</div>

        <form id="guest-form">
          <div class="form-group">
            <label class="form-label" for="firstName">First Name</label>
            <input type="text" class="form-control" id="firstName" name="firstName" required />
          </div>

          <div class="form-group">
            <label class="form-label" for="lastName">Last Name</label>
            <input type="text" class="form-control" id="lastName" name="lastName" required />
          </div>

          <div class="form-group">
            <label class="form-label" for="country">Country</label>
            <select class="form-control" id="country" name="country" required>
              <option value="Philippines" selected>Philippines</option>
              <option value="United States">United States</option>
              <option value="Canada">Canada</option>
              <option value="United Kingdom">United Kingdom</option>
              <option value="Australia">Australia</option>
              <option value="Japan">Japan</option>
              <option value="South Korea">South Korea</option>
              <option value="Singapore">Singapore</option>
              <option value="Malaysia">Malaysia</option>
              <option value="Thailand">Thailand</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label" for="email">Email</label>
            <input type="email" class="form-control" id="email" name="email" required />
          </div>

          <div class="form-group">
            <label class="form-label" for="phone">Phone Number</label>
            <input type="tel" class="form-control" id="phone" name="phone" required />
          </div>
        </form>
      </div>

      <!-- Payment Information Section -->
      <div class="col-md-6">
        <h2 class="section-title">Payment Information</h2>

        <div class="payment-section">
          <div class="payment-option">
            <input type="radio" id="payNow" name="paymentMethod" value="payNow" checked />
            <label for="payNow">Pay now</label>
            <div class="payment-icons">
              <div class="payment-icon visa">V</div>
              <div class="payment-icon mastercard">MC</div>
              <div class="payment-icon amex">AE</div>
            </div>
          </div>

          <div class="payment-note">You can also choose to pay with your credit card or other payment options below.</div>

          <button type="button" class="next-btn" onclick="proceedToPayment()">Next</button>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block extra_js %}
  <script>
    // Form validation and submission
    function proceedToPayment() {
      const form = document.getElementById('guest-form')
      const formData = new FormData(form)
    
      // Basic validation
      const requiredFields = ['firstName', 'lastName', 'email', 'phone']
      let isValid = true
    
      requiredFields.forEach((field) => {
        const input = document.getElementById(field)
        if (!input.value.trim()) {
          input.style.borderColor = '#dc3545'
          isValid = false
        } else {
          input.style.borderColor = '#cddcc9'
        }
      })
    
      if (!isValid) {
        alert('Please fill in all required fields.')
        return
      }
    
      // Email validation
      const email = document.getElementById('email').value
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
      if (!emailRegex.test(email)) {
        alert('Please enter a valid email address.')
        document.getElementById('email').style.borderColor = '#dc3545'
        return
      }
    
      // Phone validation
      const phone = document.getElementById('phone').value
      const phoneRegex = /^[\+]?[1-9][\d]{0,15}$/
      if (!phoneRegex.test(phone.replace(/\s/g, ''))) {
        alert('Please enter a valid phone number.')
        document.getElementById('phone').style.borderColor = '#dc3545'
        return
      }
    
      // Store guest information in session/localStorage
      const guestInfo = {
        firstName: formData.get('firstName'),
        lastName: formData.get('lastName'),
        country: formData.get('country'),
        email: formData.get('email'),
        phone: formData.get('phone'),
        paymentMethod: document.querySelector('input[name="paymentMethod"]:checked').value
      }
    
      localStorage.setItem('guestInfo', JSON.stringify(guestInfo))
    
      // Redirect to payment page or next step
      window.location.href = '/guestbooking/payment/'
    }
    
    // Real-time validation
    document.addEventListener('DOMContentLoaded', function () {
      const inputs = document.querySelectorAll('.form-control')
      inputs.forEach((input) => {
        input.addEventListener('blur', function () {
          if (this.value.trim()) {
            this.style.borderColor = '#7eb455'
          } else {
            this.style.borderColor = '#cddcc9'
          }
        })
      })
    })
  </script>
{% endblock %}
